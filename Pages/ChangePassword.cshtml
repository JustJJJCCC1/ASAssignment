@page
@model ASAssignment1.Pages.ChangePasswordModel
@{
    ViewData["Title"] = "Change Password";
}

<div class="container mt-5">
    <h2>Change Password</h2>

    @if (TempData["PasswordExpired"] != null)
    {
        <div class="alert alert-warning">
            @TempData["PasswordExpired"]
        </div>
    }

    @if (TempData["PasswordAgeRestriction"] != null)
    {
        <div class="alert alert-warning">
            @TempData["PasswordAgeRestriction"]
        </div>
    }


    <form method="post">
        <div class="form-group">
            <label asp-for="Input.OldPassword"></label>
            <input asp-for="Input.OldPassword" class="form-control" />
            <span asp-validation-for="Input.OldPassword" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Input.NewPassword"></label>
            <input asp-for="Input.NewPassword" class="form-control" id="passwordInput" />
            <span asp-validation-for="Input.NewPassword" class="text-danger"></span>
            <div id="passwordRequirements" class="text-muted mt-2">
                <small id="lengthReq">Minimum 8 characters</small><br />
                <small id="upperReq">At least one uppercase letter</small><br />
                <small id="lowerReq">At least one lowercase letter</small><br />
                <small id="digitReq">At least one digit</small><br />
                <small id="specialReq">At least one special character (!#$%^&*@@)</small>
            </div>
        </div>

        <div class="form-group">
            <label asp-for="Input.ConfirmPassword"></label>
            <input asp-for="Input.ConfirmPassword" class="form-control" />
            <span asp-validation-for="Input.ConfirmPassword" class="text-danger"></span>
        </div>

        <button type="submit" class="btn btn-primary mt-3">Change Password</button>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const passwordInput = document.getElementById("passwordInput");
        const lengthReq = document.getElementById("lengthReq");
        const upperReq = document.getElementById("upperReq");
        const lowerReq = document.getElementById("lowerReq");
        const digitReq = document.getElementById("digitReq");
        const specialReq = document.getElementById("specialReq");

        passwordInput.addEventListener("input", function () {
            const value = passwordInput.value;

            // Check password length
            lengthReq.style.color = value.length >= 8 ? "green" : "red";

            // Check for uppercase letters
            upperReq.style.color = /[A-Z]/.test(value) ? "green" : "red";

            // Check for lowercase letters
            lowerReq.style.color = /[a-z]/.test(value) ? "green" : "red";

            // Check for digits
            digitReq.style.color = /\d/.test(value) ? "green" : "red";

            // Check for special characters
            specialReq.style.color = /[!#$%^&*@@]/.test(value) ? "green" : "red";
        });
    });
</script>